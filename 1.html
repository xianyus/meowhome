<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <title>RPG AI ç©©å®šç‰ˆ</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        :root { --bg: #0f172a; --card: #1e293b; --accent: #38bdf8; --text: #f1f5f9; }
        body { background: var(--bg); color: var(--text); font-family: sans-serif; padding: 20px; }
        .box { background: var(--card); border: 1px solid #334155; border-radius: 12px; padding: 20px; max-width: 500px; margin: auto; }
        #chat { height: 300px; overflow-y: auto; border: 1px solid #334155; padding: 10px; margin-bottom: 10px; border-radius: 8px; font-size: 14px; }
        .user { color: var(--accent); margin-bottom: 5px; }
        .ai { color: #fff; margin-bottom: 15px; border-bottom: 1px solid #334155; padding-bottom: 10px; }
        input { width: 75%; padding: 10px; background: #000; border: 1px solid #334155; color: #fff; border-radius: 5px; }
        button { width: 20%; padding: 10px; background: var(--accent); border: none; border-radius: 5px; cursor: pointer; font-weight: bold; }
        .error-hint { color: #f87171; font-size: 12px; margin-top: 10px; display: none; }
    </style>
</head>
<body>

<div class="box">
    <h3>ğŸ§™ å†’éšªå°è©±æ¡†</h3>
    <div id="chat">
        <div class="ai">ä¸»æŒäººï¼šä½ ç«™åœ¨è¿·éœ§ç± ç½©çš„æ£®æ—å…¥å£ï¼Œè¦é€²å»å—ï¼Ÿ</div>
    </div>
    <div style="display: flex; gap: 5px;">
        <input type="text" id="userInput" placeholder="è¼¸å…¥è¡Œå‹•..." onkeypress="if(event.key==='Enter') run()">
        <button onclick="run()">ç™¼é€</button>
    </div>
    <div id="errorHint" class="error-hint">
        ğŸ’¡ æç¤ºï¼šå¦‚æœæŒçºŒå‡ºç¾ Load Failedï¼Œè«‹å˜—è©¦æ›´æ›ç€è¦½å™¨ï¼ˆæ¨è–¦ Chrome/Edgeï¼‰æˆ–æª¢æŸ¥ç¶²è·¯æ˜¯å¦é–‹å•Ÿäº† VPN/é˜²ç«ç‰†ã€‚
    </div>
</div>

<script>
    // ä½ çš„é‡‘é‘°å·²ç¶“å¡«å…¥
    const KEY = "AIzaSyB2v_uPQOH-z0_xe8WdFm45B_gUtn7rvRI";

    async function run() {
        const input = document.getElementById('userInput');
        const chat = document.getElementById('chat');
        const err = document.getElementById('errorHint');
        const text = input.value.trim();
        if (!text) return;

        chat.innerHTML += `<div class="user">ä½ ï¼š${text}</div>`;
        input.value = "";
        err.style.display = "none";

        try {
            const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${KEY}`;
            
            const response = await fetch(url, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({
                    contents: [{ parts: [{ text: `ä½ æ˜¯ä¸€ä½RPGä¸»æŒäººï¼Œè«‹å›æ‡‰ç©å®¶è¡Œå‹•ï¼š${text}` }] }]
                })
            });

            const data = await response.json();
            
            if (data.candidates && data.candidates[0].content) {
                const aiText = data.candidates[0].content.parts[0].text;
                chat.innerHTML += `<div class="ai">ä¸»æŒäººï¼š${aiText}</div>`;
            } else {
                throw new Error("API å›å‚³æ ¼å¼ç•°å¸¸");
            }
        } catch (e) {
            chat.innerHTML += `<div style="color:red">âŒ é€£ç·šå¤±æ•— (${e.message})</div>`;
            err.style.display = "block";
        }
        chat.scrollTop = chat.scrollHeight;
    }
</script>

</body>
</html>
